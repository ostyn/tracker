<template>
  <require from="./activity-detail-prompt.css"></require>
  <require from="resources/elements/activity/activity"></require>
  <dialog open>
    <article>
      <div>
        <activity id.bind="activity.id"></activity>
      </div>
      <div if.bind="editingNumber" class="activity-detail-prompt-input">
        <input
          class="inline"
          ref="inputBox"
          focus="true"
          type="text"
          value.bind="detail"
          placeholder="enter number"
        />
      </div>
      <div if.bind="!editingNumber" class="activity-detail-prompt-input">
        <div repeat.for="item of detail">
          <input
            class="width-64 inline"
            type="text"
            blur.trigger="loadMru()"
            value.bind="detail[$index]"
          /><button
            class="width-12 inline"
            click.trigger="removeItem(detail, $index)"
          >
            ❌
          </button>
        </div>
      </div>
      <hr />
      <div if.bind="!editingNumber">
        <form submit.trigger="addItemOrSubmit()">
          <input
            class="width-64 inline"
            ref="inputBox"
            focus="true"
            type="text"
            value.bind="newItem"
            placeholder="add item"
          />
          <button
            class="inline"
            if.bind="newItem"
            click.trigger="addItemOrSubmit()"
          >
            ▶
          </button>
        </form>
      </div>
      <div class="stats-block">
        <div class="stats-column">
          <div
            repeat.for="detail of mfuDetails"
            click.trigger="addDetail(detail.text)"
            class="stats-entry"
          >
            <span class="stats-entry-datapoint">${detail.count}</span
            >${detail.text}
          </div>
        </div>
        <div class="stats-column">
          <div
            repeat.for="detail of mruDetails"
            click.trigger="addDetail(detail.text)"
            class="stats-entry"
          >
            <span class="stats-entry-datapoint">${detail.dates[0].date}</span
            >${detail.text}
          </div>
        </div>
      </div>
      <footer>
        <button
          class="inline"
          disabled.bind="editingNumber && !isNumeric(detail)"
          click.trigger="submitForm()"
        >
          done
        </button>
        <button class="inline" click.trigger="controller.cancel()">
          cancel
        </button>
      </footer>
    </article>
  </dialog>
</template>
