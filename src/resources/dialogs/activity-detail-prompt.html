<template>
  <require from="./activity-detail-prompt.css"></require>
  <require from="resources/elements/activity/activity"></require>
  <ux-dialog>
    <ux-dialog-body">
      <div>
        <activity id.bind="activity.id"></activity>
      </div>
      <div if.bind="editingNumber" class="inline-block align-top">
        <input
          ref="inputBox"
          focus="true"
          type="text"
          value.bind="detail"
          placeholder="enter number"
        />
      </div>
      <div if.bind="!editingNumber" class="inline-block align-top">
        <div repeat.for="item of detail">
          <input
            class="w-64"
            type="text"
            blur.trigger="loadMru()"
            value.bind="detail[$index]"
          /><button class="w-12" click.trigger="removeItem(detail, $index)">
            ❌
          </button>
        </div>
      </div>
      <hr />
      <div if.bind="!editingNumber">
        <form submit.trigger="addItemOrSubmit()">
          <input
            class="w-64"
            ref="inputBox"
            focus="true"
            type="text"
            value.bind="newItem"
            placeholder="add item"
          />
          <button if.bind="newItem" click.trigger="addItemOrSubmit()">▶</button>
        </form>
      </div>
      <div class="flex">
        <div class="inline-block w-1/2 select-none">
          <div
            repeat.for="detail of mfuDetails"
            click.trigger="addDetail(detail.text)"
            class="p-3"
          >
            <span
              class="inline-flex items-center justify-center px-2 py-0 mr-2 text-xs text-white bg-black border-black rounded-full border-1"
              >${detail.count}</span
            >${detail.text}
          </div>
        </div>
        <div class="inline-block w-1/2 select-none">
          <div
            repeat.for="detail of mruDetails"
            click.trigger="addDetail(detail.text)"
            class="p-3"
          >
            <span
              class="inline-flex items-center justify-center px-2 py-0 mr-2 text-xs text-white bg-black border-black rounded-full border-1"
              >${detail.dates[0].date}</span
            >${detail.text}
          </div>
        </div>
      </div>
    </ux-dialog-body>
    <ux-dialog-footer>
      <button
        disabled.bind="editingNumber && !isNumeric(detail)"
        click.trigger="submitForm()"
      >
        done
      </button>
      <button click.trigger="controller.cancel()">cancel</button>
    </ux-dialog-footer>
  </ux-dialog>
</template>
