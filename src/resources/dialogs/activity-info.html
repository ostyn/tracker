<template>
  <require from="resources/elements/activity/activity"></require>
  <require from="resources/elements/calendar/calendar-wrapper"></require>
  <ux-dialog>
    <ux-dialog-body>
      <activity id.bind="activityId"></activity>
      <div>This month: ${daysWithActivity}</div>
      <div>Percent of days: ${percentOfDays}%</div>
      <div>Total Count: ${totalActivity}</div>
      <div>Average per day: ${(totalActivity/daysWithActivity).toFixed(2)}</div>
      <calendar-wrapper
        if.bind="!loading"
        dates.bind="relatedEntryMap"
        year.bind="year"
        month.bind="month"
        day.bind="day"
        activity-id.bind="activityId"
        on-date-select.call="onDateSelect(date)"
        on-month-change.call="onMonthChange(month, year)"
      ></calendar-wrapper>
      <div>
        <ul>
          <li
            class="my-2 cursor-pointer"
            click.trigger="onDateSelect(key)"
            repeat.for="[key, value] of relatedEntryMap"
          >
            <span
              class="inline-flex items-center justify-center px-2 py-0 mr-2 text-xs text-white bg-black border-black rounded-full border-1"
              >${key}</span
            >
            <span
              class="inline-flex items-center text-center justify-center m-0.5 px-2 py-0.5 text-xs text-white bg-blue-600 rounded-md"
              repeat.for="textItem of value.activities.get(activityId)"
              >${textItem}</span
            >
          </li>
        </ul>
      </div>
      <input
        if.bind="showLists"
        ref="inputBox"
        type="text"
        value.bind="filter"
        placeholder="search..."
      />
      <div if.bind="showLists" class="flex">
        <div class="inline-block w-1/2 select-none">
          <div
            click.trigger="onDateSelect(detail.dates[0])"
            repeat.for="detail of mfuDetails"
            class="p-3 cursor-pointer"
          >
            <span
              class="inline-flex items-center justify-center px-2 py-0 mr-2 text-xs text-white bg-black border-black rounded-full border-1"
              >${detail.count}</span
            >${detail.text}
          </div>
        </div>
        <div if.bind="showLists" class="inline-block w-1/2 select-none">
          <div
            click.trigger="onDateSelect(detail.dates[0])"
            repeat.for="detail of mruDetails"
            class="p-3 cursor-pointer"
          >
            <span
              class="inline-flex items-center justify-center px-2 py-0 mr-2 text-xs text-white bg-black border-black rounded-full border-1"
              >${detail.dates[0]}</span
            >${detail.text}
          </div>
        </div>
      </div>
    </ux-dialog-body>
    <ux-dialog-footer>
      <button click.trigger="controller.cancel()">Close</button>
    </ux-dialog-footer>
  </ux-dialog>
</template>
